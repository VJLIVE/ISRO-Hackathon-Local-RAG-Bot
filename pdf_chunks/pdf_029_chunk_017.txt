applying an appropriate threshold on visible channel measurements, however, thin clouds especially at cloud edges frequently create problems. An astringent threshold can be used to mask such pixels but it also masks heavy aerosol plumes. For this reason in the present algorithm, a visible channel threshold is used to mask thick clouds only. For masking scattered clouds, a spatial homogeneity test is performed by estimating the standard deviation over a running window of 3x3 pixels. An appropriate threshold is used to detect scattered cloudy pixels keeping the fact in mind that the land surface is more homogeneous than the scattered clouds. For cloud masking following 2 tests are performed: (a) Visible channel (band-2) reflectance threshold test: ğœŒ443 ğ‘›ğ‘š > 0.30 Pixel is considered cloudy. (3) (b) Threshold test on the standard deviation of a running 3 x 3-pixel window of band-2 image. ğœ443ğ‘›ğ‘š,3 ğ‘¥ 3 > 0.02 Center pixel is considered cloudy. (4) The inland water mask is determined by computing the traditional NDVI like parameter (NDVIâ€™) for the 0.62 Î¼m and the 0.865 Î¼m channels. ğ‘ğ·ğ‘‰ğ¼â€² = ğœŒğµ8,ğ‘‡ğ‘‚ğ´âˆ’ğœŒğµ6,ğ‘‡ğ‘‚ğ´ ğœŒğµ8,ğ‘‡ğ‘‚ğ´+ğœŒğµ6,ğ‘‡ğ‘‚ğ´ (5) If ğ‘ğ·ğ‘‰ğ¼â€² < 0.05 then the pixel is considered water contaminated and is masked. The test for pixel saturation is also performed using saturation radiance (ğ¿ğ‘ ğ‘ğ‘¡ ) values for each band. If measured radiance (ğ¿ğµ) in any band satisfies the condition ğ¿ğµ> ğ¿ğ‘ ğ‘ğ‘¡ (6) then the pixel is considered saturated and is masked. Any pixel with solar zenith angle (ğœƒ0) or sensor zenith angle (ğœƒ0) above-given limits are also masked. The condition for the high zenith angle test is given by: ğœƒ0 > 720 or ğœƒ> 840 (7) 4.3.3 Physical basis and model for surface characterization The physical basis behind surface characterization in visible channels using NIR channels is based on the fact that over the vegetated surface, the