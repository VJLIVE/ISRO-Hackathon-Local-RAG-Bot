test is done to assign probably clear or cloudy flag to each pixel. In this test Over land : If 2 < | BT11 – BTmax | ≤ 6 then cloudflag = 2 (probably clear) And if 6 < | BT11 – BTmax | ≤ 12 then cloudflag = 3 (probably cloudy) Over ocean : If 2 < | BT11 – BTmax | ≤ 3 then cloudflag = 2 (probably clear) And if 3 < | BT11 – BTmax | ≤ 6 then cloudflag = 3 (probably cloudy) For further testing one can use the reflectance test in visible and some other test to determine whether it is clear or cloudy. Cloud Mask INSAT-3D ATBD Document, May 2015 24 2.4.1.4 Flow Chart Clear sky surface temperature (Tmax) Apply BT Threshold test Apply diff. test (BT11- BT3.7) Apply diff. test (BT3.7- BT12) Spatial variability test Spatial Uniformity Test Adjacent pixel test Output Cloud flag for every pixel Cloud flag = 0 , clear pixel Cloud flag = 1, cloudy pixel Cloud flag = 2, probably clear Cloud flag = 3, probably cloudy Cloud flag = 9 , cold space Compute clear composite Tmax for each time using previous images Temporal uniformity test Final threshold test Calculate solar zenith angle Cloud Mask INSAT-3D ATBD Document, May 2015 25 2.4.2 Operational Implementation 2.4.2.1 Step 1 : Generation of BTmax 2.4.2.2 Step 2: BT threshold test 2.4.2.3 Step 3 : Solar zenith angle calculation 2.4.2.4 Step 4 : Difference Test ( BT11 – BT3.7) 2.4.2.5 Step 5 : Difference Test ( BT3.7 – BT12) 2.4.2.6 Step 6 : Spatial variability test 2.4.2.7 Step 7 : Spatial Uniformity test 2.4.2.8 Step 8 : Adjacent pixel test 2.4.2.9 Step 9: Temporal Uniformity test 2.4.2.10 Step 10: Final threshold test 2.5 Outputs Parameter Resolution Cloud flag Pixel